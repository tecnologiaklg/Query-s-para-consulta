#type.sql# 
SELECT
CAB.AD_ANOT_COM
FROM
TGFCAB CAB,

(SELECT
ATT.CODPARC,
MAX(ATT.NUNOTA) AS ULTNOTA
FROM
(SELECT
CAB.CODPARC,
CAB.NUNOTA
FROM
TGFCAB CAB
WHERE
CAB.CODTIPOPER = '3108'
AND CAB.NUNOTA <> TGFCAB.NUNOTA
) ATT
GROUP BY
ATT.CODPARC
) AAA

WHERE
AAA.CODPARC = CAB.CODPARC
AND CAB.CODTIPOPER = '3108'
AND CAB.NUNOTA = AAA.ULTNOTA
AND CAB.CODPARC = TGFCAB.CODPARC