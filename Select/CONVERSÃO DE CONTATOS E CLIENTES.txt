SELECT
ORC.CODPARC,
ORC.NOMECONTATO,
ORC.ORCAMENTO,
VEN.VENDA,
(VEN.VENDA / ORC.ORCAMENTO) * 100 AS CONVERSAO

FROM
(SELECT
    ORC.CODPARC,
    CTT.NOMECONTATO,
    COUNT(ORC.NUNOTA) AS ORCAMENTO
    FROM
    TGFCAB ORC
    LEFT JOIN TGFCTT CTT ON CTT.CODPARC = ORC.CODPARC AND CTT.CODCONTATO = ORC.CODCONTATO
    WHERE
    ORC.CODTIPOPER IN ('3100','3102')
    AND ORC.DTNEG BETWEEN '01/09/2024' AND '30/09/2025'
    GROUP BY
    ORC.CODPARC,
    CTT.NOMECONTATO) ORC
LEFT JOIN (SELECT
    VEN.CODPARC,
    CTT.NOMECONTATO,
    COUNT(VEN.NUNOTA) AS VENDA
    FROM
    TGFCAB VEN
    LEFT JOIN TGFCTT CTT ON CTT.CODPARC = VEN.CODPARC AND CTT.CODCONTATO = VEN.CODCONTATO
    WHERE
    VEN.CODTIPOPER IN ('3200','3205','3250')
    AND VEN.DTNEG BETWEEN '01/09/2024' AND '30/09/2025'
    GROUP BY
    VEN.CODPARC,
    CTT.NOMECONTATO) VEN ON VEN.CODPARC = ORC.CODPARC AND VEN.NOMECONTATO = ORC.NOMECONTATO