SELECT
CAB.NUNOTA,
CAB.CODTIPOPER,
TOP.DESCROPER,
CAB.DTNEG,
CAB.CODPARC,
PAR.RAZAOSOCIAL,
CAB.CODVEND,
VEN.APELIDO,
CAB.NUMNOTA,
-- Valores
CAB.VLRIPI,
CAB.VLRFRETE,
CAB.VLRSUBST,
CAB.VLRICMSDIFALDEST,
CAB.VLRICMSFCP,
DECODE (CAB.TIPMOV,'V','+','D','-') AS OPERADOR,
CAB.VLRNOTA,
SUM ((CAB.VLRNOTA -CAB.VLRIPI -CAB.VLRFRETE -CAB.VLRSUBST -CAB.VLRICMSDIFALDEST -CAB.VLRICMSFCP) /28) AS VLR_LIQ 

FROM
TGFCAB CAB
JOIN TGFPAR PAR ON CAB.CODPARC = PAR.CODPARC
JOIN TGFVEN VEN ON CAB.CODVEND = VEN.CODVEND
JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER

WHERE
CAB.CODTIPOPER IN (3200, 3205, 3250, 3262, 2200, 2201, 2207, 2209)
AND CAB.DTNEG >= '01/07/2020' --INICIAL
AND CAB.DTNEG <= '01/08/2020' --FINAL
AND CAB.CODVEND = '2' --VENDEDOR

GROUP BY
CAB.NUNOTA,
CAB.CODTIPOPER,
TOP.DESCROPER,
CAB.DTNEG,
CAB.CODPARC,
PAR.RAZAOSOCIAL,
CAB.CODVEND,
VEN.APELIDO,
CAB.NUMNOTA,
-- Valores
CAB.VLRIPI,
CAB.VLRFRETE,
CAB.VLRSUBST,
CAB.VLRICMSDIFALDEST,
CAB.VLRICMSFCP,
CAB.TIPMOV AS OPERADOR,
CAB.VLRNOTA
