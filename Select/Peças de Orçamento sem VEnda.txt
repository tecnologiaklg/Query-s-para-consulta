SELECT
ITE.CODPROD,
ITE.QTDNEG,
PRO.DESCRPROD,
CAB.DTNEG,
CAB.AD_UF,
ITE.NUNOTA


FROM
TGFITE ITE
JOIN TGFPRO PRO ON ITE.CODPROD = PRO.CODPROD
JOIN TGFCAB CAB ON ITE.NUNOTA = CAB.NUNOTA

WHERE
CAB.CODTIPOPER = '3100' AND
CAB.DTNEG >= '01/01/2021' AND CAB.DTNEG <= '30/06/2021' AND 
NOT EXISTS (SELECT * FROM TGFVAR S WHERE ITE.NUNOTA = S.NUNOTAORIG)
