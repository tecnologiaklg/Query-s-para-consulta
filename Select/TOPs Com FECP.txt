SELECT
DISTINCT (CAB.NUNOTA),
CAB.AD_UF AS UF,
CAB.CODEMP AS EMPRESA,
CAB.VLRICMSFCP AS FCP_ICMS,
CAB.VLRSTFCPINT AS FCP_ST,
CAB.CODTIPOPER AS COD,
TOP.DESCROPER AS OPERACAO,
PAR.RAZAOSOCIAL,
CAB.CODPARC

FROM
TGFCAB CAB
JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER
JOIN TGFPAR PAR ON CAB.CODPARC = PAR.CODPARC

WHERE
CAB.AD_UF <> 'SÃ£o Paulo' AND TOP.TIPMOV = 'P'
