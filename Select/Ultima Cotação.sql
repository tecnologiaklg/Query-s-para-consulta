SELECT
ITC.CODPARC,
PAR.RAZAOSOCIAL,
ITC.CODPROD,
PRO.DESCRPROD,
ITC.PRECO,
ITC.VLRMOEDA,
ITC.VLRDESCMOE,
ITC.DTCOLETAPRECO,
ITC.NUMCOTACAO

FROM
TGFITC ITC,
TGFPAR PAR,
TGFPRO PRO,
(SELECT 
ITC.CODPROD,
ITC.CODPARC,
MAX (ITC.DTCOLETAPRECO) AS ULTDATA

FROM
TGFITC ITC

GROUP BY
ITC.CODPROD,
ITC.CODPARC
) DAT


WHERE
ITC.CODPARC = PAR.CODPARC
AND DAT.CODPROD = ITC.CODPROD
AND DAT.CODPARC = ITC.CODPARC
AND ITC.CODPROD = PRO.CODPROD
AND ITC.CODPARC <> '0'
AND PRO.USOPROD = 'R'
AND ITC.DTCOLETAPRECO = DAT.ULTDATA

ORDER BY 
ITC.CODPROD