SELECT
PAR.CODPARC,
PAR.RAZAOSOCIAL,
AAA.FAT1SEM,
CASE
WHEN AAA.FAT1SEM >=  '9037,91' THEN 'A'
WHEN AAA.FAT1SEM <= '9037,90' AND AAA.FAT1SEM >= '2401,38' THEN 'B'
WHEN AAA.FAT1SEM <=  '2401,37' THEN 'C'
ELSE 'D' END AS CURVA_1SEM,
BBB.FAT2SEM,
CASE
WHEN BBB.FAT2SEM >=  '9037,91' THEN 'A'
WHEN BBB.FAT2SEM <= '9037,90' AND BBB.FAT2SEM >= '2401,38' THEN 'B'
WHEN BBB.FAT2SEM <=  '2401,37' THEN 'C'
ELSE 'D' END AS CURVA_2SEM

FROM
TGFPAR PAR
LEFT JOIN (SELECT
CAB.CODPARC,
SUM (CAB.VLRNOTA) AS FAT1SEM
FROM
TGFCAB CAB
WHERE
CAB.DTNEG BETWEEN (CURRENT_DATE - 180) AND CURRENT_DATE
AND CAB.CODTIPOPER IN ('3200','3205','3250','3262')
GROUP BY
CAB.CODPARC
) AAA ON AAA.CODPARC = PAR.CODPARC
LEFT JOIN (SELECT
CAB.CODPARC,
SUM (CAB.VLRNOTA) AS FAT2SEM
FROM
TGFCAB CAB
WHERE
CAB.DTNEG BETWEEN (CURRENT_DATE - 360) AND (CURRENT_DATE - 181)
AND CAB.CODTIPOPER IN ('3200','3205','3250','3262')
GROUP BY
CAB.CODPARC
) BBB ON BBB.CODPARC = PAR.CODPARC

WHERE
PAR.CLIENTE = 'S'